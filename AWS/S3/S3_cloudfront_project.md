# プロジェクト1：S3 + CloudFront による高セキュリティ静的サイトの構築  
  
## 1. プロジェクト概要  
  
本プロジェクトでは、Amazon S3 と Amazon CloudFront を組み合わせた、実務レベルの静的ウェブサイト配信インフラを構築しました。 単にファイルを公開するのではなく、**「外部からの直接アクセスを遮断し、特定の経路（CDN）のみを許可する」**という、エンタープライズ環境で標準とされるセキュアな設計を再現しています。

## 2. 構築の目的  
  
インフラエンジニアを目指す上で、以下の3点を実証・習得することを目的としました。  
  
- **セキュリティ・ファーストの設計能力**:  
「とりあえず動く」パブリック設定を避け、AWSのベストプラクティス（OAC）に基づいた非公開設定での構築。  
- **Infrastructure as Code (IaC) の実践**:  
マネジメントコンソール（GUI）での手動構築による構造理解とCloudFormationによるコード管理の両立。  
- **トラブルシューティングの完遂能力**:  
403エラーや構文エラーなどの技術的障壁に対し、自力で解決するプロセスの習得。  
  
## 3. 採用した技術スタックと選定理由  
  
| 技術要素 | 選定理由 |
| :--- | :--- |
| Amazon S3 | 耐久性の高いオブジェクトストレージとして採用。バケットは完全非公開（パブリックアクセス遮断）に設定。 |
| Amazon CloudFront | グローバル配信による低遅延化、HTTPS通信の強制、およびエッジでのアクセス制御のため。 |
| Origin Access Control (OAC) | 非公開S3に対し、CloudFrontからの署名付きリクエストのみを許可する最新の認証方式。 |
| CloudFormation | インフラの再現性を確保し、設定の意図をコードとしてドキュメント化するため。 |
  
## 4. 学習プロセス  
  
### ① GUI構築から学んだサービス間の「繋がり」  
  
まずはマネジメントコンソールで手動構築を行い、各設定項目の依存関係を学びました。
  
- **気づき**: CloudFrontの「オリジン」設定とS3の「バケットポリシー」が連動して初めてアクセスが許可される仕組みや、OACが発行する「通行証（署名）」をS3側で検証する流れを理解しました。
  
### ② 仕組みへの深い洞察：403 Access Denied の解決  
  
構築後、ドメイン名のみ（/）でアクセスすると 403 Access Denied が発生する問題に直面しました。
  
- **原因の特定**: S3ウェブサイトエンドポイント（公開用）と異なり、今回採用したREST APIエンドポイント経由のアクセスでは、S3側がディレクトリインデックス（/ を index.html と読み替える）機能を持たないことを特定しました。
- **解決策**: CloudFrontの DefaultRootObject に index.html を設定。CDN側でリクエストを適切にハンドリングさせる設計へと修正しました。これにより、各サービスの役割の境界線を深く理解できました。
  
### ③ CloudFormation 実装における「厳密さ」の追求  
  
手動設定をコードに落とし込む過程で、多くのシンタックスエラーに直面し、デバッグを繰り返しました。  
  
- **直面した課題**:
    - `Condition` を `Conditon` と書く等のスペルミス
    - `Resource`（単数）と `Resources`（複数）の混同
    - `AWS::AccountId` を `aws::AcoountId` と書く等の擬似パラメータの誤記
- **得られた教訓**: インフラをコードで定義する以上、1文字のミスがシステム全体の不整合を招く。AWSリファレンスを徹底的に読み込み、エラーメッセージから原因を特定するの習慣を確立しました。  
  
## 5. 今後の展望  
  
今後は以下の拡張を予定しています。  
  
- [ ] CircleCI による CI/CD 統合: GitHubへのプッシュをトリガーとした、S3への自動同期およびCloudFrontのキャッシュクリア（Invalidation）の完全自動化。  
- [ ] 独自ドメイン・ACMの適用: Route 53 を用いたドメイン管理と、SSL/TLS証明書による信頼性の向上。  
  
## 6. 自己評価  
  
今回の構築を通じて、AWSの主要サービスが相互にどのように認証し合っているのか（IAM/バケットポリシー/OAC）を、コードレベルで理解することができました。安易な方法を選ばず、一見複雑な「非公開＋署名付きアクセス」を完遂したことは、実務においても高いセキュリティ意識を持って取り組める自信に繋がりました。